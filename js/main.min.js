(function(e,t){var s=t.body,a=t.querySelector.bind(t),n=t.querySelectorAll.bind(t),o=a("html"),r=a("#gotop"),l=a("#menu"),c=a("#header"),d=a("#mask"),h=a("#menu-toggle"),f=a("#menu-off"),u=a("#loading"),v=e.requestAnimationFrame,g=12,m=Array.prototype.forEach,p="ontouchstart"in e&&/Mobile|Android|iOS|iPhone|iPad|iPod|Windows Phone|KFAPWI/i.test(navigator.userAgent)?"touchstart":"click",L=/micromessenger/i.test(navigator.userAgent),x=function(){},y=function(e){var t=e.offsetLeft,i=e.offsetTop;if(e.offsetParent){var s=arguments.callee(e.offsetParent);t+=s.x,i+=s.y}return{x:t,y:i}},w=navigator.userAgent.indexOf("Firefox")!==-1?t.documentElement:s,E={goTop:function(e){var t=w.scrollTop,i=arguments.length>2?arguments[1]:Math.abs(t-e)/g;t&&t>e?(w.scrollTop=Math.max(t-i,0),v(arguments.callee.bind(this,e,i))):e&&t<e?(w.scrollTop=Math.min(t+i,e),v(arguments.callee.bind(this,e,i))):this.toc.actived(e)},toggleGotop:function(t){t>e.innerHeight/2?r.classList.add("in"):r.classList.remove("in")},toggleMenu:function(t){var i=a("#main");if(t){if(l.classList.remove("hide"),e.innerWidth<1241)if(d.classList.add("in"),l.classList.add("show"),L){var s=w.scrollTop;i.classList.add("lock"),i.scrollTop=s}else o.classList.add("lock")}else if(l.classList.remove("show"),d.classList.remove("in"),L){var s=i.scrollTop;i.classList.remove("lock"),w.scrollTop=s}else o.classList.remove("lock")},fixedHeader:function(e){e>c.clientHeight?c.classList.add("fixed"):c.classList.remove("fixed")},toc:function(){var e=a("#post-toc");if(!e||!e.children.length)return{fixed:x,actived:x};var t=y(e),s=t.y,o=c.clientHeight,r=a("#post-content").querySelectorAll("h1, h2, h3, h4, h5, h6");return e.querySelector('a[href="#'+r[0].id+'"]').parentNode.classList.add("active"),m.call(n('a[href^="#"]'),function(e){e.addEventListener("click",function(e){e.preventDefault();var t=y(a('[id="'+decodeURIComponent(this.hash).substr(1)+'"]')).y-o;v(E.goTop.bind(E,t))})}),{fixed:function(t){t>s-o?e.classList.add("fixed"):e.classList.remove("fixed")},actived:function(t){for(i=0,len=r.length;i<len;i++)if(t>y(r[i]).y-o-5){e.querySelector("li.active").classList.remove("active");var s=e.querySelector('a[href="#'+r[i].id+'"]').parentNode;s.classList.add("active")}t<y(r[0]).y&&(e.querySelector("li.active").classList.remove("active"),e.querySelector('a[href="#'+r[0].id+'"]').parentNode.classList.add("active"))}}}(),hideOnMask:[],modal:function(e){this.$modal=a(e),this.$off=this.$modal.querySelector(".close");var t=this;this.show=function(){d.classList.add("in"),t.$modal.classList.add("ready"),setTimeout(function(){t.$modal.classList.add("in")},0)},this.onHide=x,this.hide=function(){t.onHide(),d.classList.remove("in"),t.$modal.classList.remove("in"),setTimeout(function(){t.$modal.classList.remove("ready")},300)},this.toggle=function(){return t.$modal.classList.contains("in")?t.hide():t.show()},E.hideOnMask.push(this.hide),this.$off&&this.$off.addEventListener(p,this.hide)},share:function(){var e=a("#pageShare"),i=a("#shareFab"),s=new this.modal("#globalShare");a("#menuShare").addEventListener(p,s.toggle),i&&(i.addEventListener(p,function(){e.classList.toggle("in")},!1),t.addEventListener(p,function(t){!i.contains(t.target)&&e.classList.remove("in")},!1));var o=new this.modal("#wxShare");o.onHide=s.hide,m.call(n(".wxFab"),function(e){e.addEventListener(p,o.toggle)})},search:function(){function e(){t.classList.toggle("in")}var t=a("#search-wrap");a("#search").addEventListener(p,e)},reward:function(){var e=new this.modal("#reward");a("#rewardBtn").addEventListener(p,e.toggle)},fixNavMinH:function(){function e(){t.style.minHeight=t.parentNode.clientHeight-t.nextElementSibling.offsetHeight+"px"}var t=a(".nav");return e}(),waterfall:function(){e.innerWidth<760||m.call(n(".waterfall"),function(e){var t=e.querySelectorAll(".waterfall-item"),i=[0,0];m.call(t,function(e){var t=i[0]<=i[1]?0:1;e.style.cssText="top:"+i[t]+"px;left:"+(t>0?"50%":0),i[t]+=e.offsetHeight}),e.style.height=Math.max(i[0],i[1])+"px",e.classList.add("in")})},tabBar:function(e){e.parentNode.parentNode.classList.toggle("expand")},page:function(){var e=n(".fade, .fade-scale");return{loaded:function(){m.call(e,function(e){e.classList.add("in")})},unload:function(){m.call(e,function(e){e.classList.remove("in")})}}}(),lightbox:function(){function i(){r.x=e.innerWidth||w.clientWidth||s.clientWidth,r.y=e.innerHeight||w.clientHeight||s.clientHeight}function a(){if(this.isZoomed){this.isZoomed=!this.isZoomed,o=null,this.img.style.cssText="",this.wrapper.style.cssText="",this.overlay.className="zoom-overlay";var e=this;setTimeout(function(){e.placeholder.style.cssText="",e.children[0].appendChild(e.img),e.children[0].removeChild(e.wrapper),e.img.classList.remove("zoom-img")},300)}else{this.isZoomed=!this.isZoomed,o=this,this.img||(this.img=this.querySelector("img"));var i=this.img.getBoundingClientRect().height,s=this.img.getBoundingClientRect().width,a=this.img.getBoundingClientRect().left,n=this.img.getBoundingClientRect().top,d=this.img.naturalWidth||s,h=this.img.naturalHeight||i;this.placeholder=this.querySelector(".placeholder"),this.placeholder.style.cssText="height: "+i+"px";var f=(r.y-this.img.offsetHeight)/2,u=(r.x-this.offsetWidth)/2;this.img.classList.add("zoom-img"),this.overlay=t.createElement("div"),this.overlay.id="the-overlay",this.overlay.className="zoom-overlay",this.overlay.style.cssText="height:"+r.y+"px; width: "+r.x+"px; top: -"+f+"px; left: -"+u+"px",this.wrapper=t.createElement("div"),this.wrapper.id="the-wrapper",this.wrapper.className="zoom-img-wrap abs",this.wrapper.appendChild(this.img),this.wrapper.appendChild(this.overlay),this.children[0].appendChild(this.wrapper);var v=this.img.title||this.img.alt;v&&(this.caption=t.createElement("div"),this.caption.className="zoom-img-title",this.caption.innerHTML=v,this.caption.style.cssText="width: "+r.x+"px; top: "+(r.y-f-30)+"px; left: -"+u+"px",this.wrapper.appendChild(this.caption));var g=(r.x-c)/2-a-s/2,m=n*-1+(r.y-i)/2,p=1;h>i&&(i===s&&r.y>r.x?p=r.x/s:i===s&&r.y<r.x?p=(r.y-l)/i:i>s?(p=(r.y-l)/i,p*s>r.x&&(p=r.x/s)):i<s&&(p=r.x/s,p*i>r.y&&(p=(r.y-l)/i))),p*s>d&&(p=d/s);var e=this;setTimeout(function(){var t="translate3d("+g+"px, "+m+"px, 0)",i="scale("+p+")";e.wrapper.style.cssText="transform: "+t+";-webkit-transform: "+t,e.img.style.cssText="transform: "+i+";-webkit-transform: "+i,e.overlay.className="zoom-overlay show"},0)}}var o,r={},l=0,c=e.innerWidth-w.offsetWidth;return i(),m.call(n(".post-content .img-lightbox"),function(e){e.addEventListener(p,a)}),{updateScreenSize:i,zoomOut:function(){o&&o[p]()}}}},T=E.lightbox();e.addEventListener("load",function(){E.fixNavMinH(),E.waterfall();var e=w.scrollTop;E.toc.fixed(e),E.toc.actived(e),u.classList.remove("active"),E.page.loaded()}),e.addEventListener("beforeunload",function(){E.page.unload()}),e.addEventListener("resize",function(){e.BLOG.even=p="ontouchstart"in e?"touchstart":"click",E.fixNavMinH(),E.toggleMenu(),E.waterfall(),T.updateScreenSize()}),r.addEventListener(p,function(){v(E.goTop.bind(E,0))},!1),h.addEventListener(p,function(e){E.toggleMenu(!0),e.preventDefault()},!1),f.addEventListener(p,function(){l.classList.add("hide")},!1),d.addEventListener(p,function(e){E.toggleMenu(),E.hideOnMask.forEach(function(e){e()}),e.preventDefault()},!1),t.addEventListener("scroll",function(){var e=w.scrollTop;E.toggleGotop(e),E.fixedHeader(e),E.toc.fixed(e),E.toc.actived(e),T.zoomOut()},!1),e.BLOG.SHARE&&E.share(),e.BLOG.REWARD&&E.reward(),E.docEl=w,E.noop=x,E.even=p,E.$=a,E.$$=n,Object.keys(E).reduce(function(e,t){return e[t]=E[t],e},e.BLOG),Waves.init(),Waves.attach(".global-share li",["waves-block"]),Waves.attach(".article-tag-list-link, #page-nav a, #page-nav span",["waves-button"])})(window,document);